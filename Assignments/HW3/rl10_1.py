import numpy as np
import scipy.linalg
from matplotlib import pyplot as plt

Q = [0, 0, 0, 0]
R = [0, 0, 0, 0]

x0 = np.array([[3.59426033], [13.90633571], [19.78895697], [2.90784436], [4.42170932]])
A = np.array([[0.00000000, 0.00000000, 0.00000000, 0.00000000, -0.50000000], [0.00000000, 0.00000000, -1.00000000, 0.00000000, 0.50000000], [0.00000000, 0.00000000, 1.50000000, 1.50000000, 0.00000000], [-1.50000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000], [0.00000000, 0.00000000, -2.00000000, -0.50000000, 0.00000000]])
B = np.array([[0.00000000, 0.00000000, 0.00000000], [0.00000000, 1.00000000, 0.00000000], [0.00000000, 0.00000000, 0.00000000], [1.00000000, 0.00000000, 1.00000000], [0.00000000, 0.00000000, 0.00000000]])
Q[0] = np.array([[5.10868641, 1.75904467, 1.10298217, -0.74197417, 1.81275948], [1.75904467, 4.67547888, 0.06170442, 0.26437457, 1.32191646], [1.10298217, 0.06170442, 5.11513028, -0.36363484, 0.30148100], [-0.74197417, 0.26437457, -0.36363484, 6.09268675, -1.99838003], [1.81275948, 1.32191646, 0.30148100, -1.99838003, 5.11272128]])
R[0] = np.array([[2.97764080, 2.69924574, 0.02061252], [2.69924574, 3.49457224, 1.19948749], [0.02061252, 1.19948749, 8.95535034]])
Q[1] = np.array([[4.88354858, -2.65164814, 0.36931201, -0.65658305, -0.67277142], [-2.65164814, 7.92522303, 0.32102772, -0.89223506, -0.12257809], [0.36931201, 0.32102772, 9.04774926, -0.21127548, -1.11256610], [-0.65658305, -0.89223506, -0.21127548, 7.55491674, -0.24499982], [-0.67277142, -0.12257809, -1.11256610, -0.24499982, 7.22626611]])
R[1] = np.array([[5.17313752, 0.14430509, 0.41157909], [0.14430509, 4.13582719, 0.60902231], [0.41157909, 0.60902231, 8.37251906]])
Q[2] = np.array([[8.37268805, -0.27756587, 0.14821163, 0.02783446, -0.10883234], [-0.27756587, 8.81668755, -0.68397139, -0.54663983, 0.21958144], [0.14821163, -0.68397139, 7.20315536, -0.96358369, -0.76534424], [0.02783446, -0.54663983, -0.96358369, 8.64132184, -0.22917615], [-0.10883234, 0.21958144, -0.76534424, -0.22917615, 8.90292473]])
R[2] = np.array([[6.11533383, -0.08698230, -0.47283869], [-0.08698230, 6.84337019, -0.29096843], [-0.47283869, -0.29096843, 5.85979083]])
Q[3] = np.array([[6.99259166, -0.54436968, 0.22132230, 0.64518171, -0.83121983], [-0.54436968, 7.20427516, 0.65853601, -1.81460251, 0.18634518], [0.22132230, 0.65853601, 8.45468198, -0.30480235, -1.20967327], [0.64518171, -1.81460251, -0.30480235, 4.08549560, -0.42132141], [-0.83121983, 0.18634518, -1.20967327, -0.42132141, 6.37455169]])
R[3] = np.array([[5.66853264, -0.02511454, -0.43447271], [-0.02511454, 7.97439472, -0.49926982], [-0.43447271, -0.49926982, 6.92954646]])

for i in range(4):
    P = np.matrix(scipy.linalg.solve_discrete_are(A, B, Q[i], R[i]))
    K = -1*np.matrix(scipy.linalg.inv(np.transpose(B)*P*B + R[i])*(np.transpose(B)*P*A))

    u = np.matmul(K, x0)

    print(np.array2string(K, separator=","))
    J_x0 = np.matmul(x0.T, np.matmul(Q[i], x0))+np.matmul(u.T, np.matmul(R[i], u))
    J = np.matmul(x0.T, np.matmul(P, x0))

    # print(J_x0)
    print(J)
    

    