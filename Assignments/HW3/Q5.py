import numpy as np
import scipy.linalg
from scipy.linalg import *

Q = [None] * 4
R = [None] * 4

x0 = np.array([[1.11880576], [8.51619367], [5.75599439], [3.51452434], [11.35862954]])
A = np.array([[0.00000000, -2.00000000, 0.00000000, -1.50000000, 0.00000000], [1.00000000, 0.00000000, -2.00000000, 0.00000000, -0.50000000], [0.00000000, 0.00000000, 0.00000000, -0.50000000, -0.50000000], [2.00000000, 0.00000000, -1.50000000, 2.00000000, 0.50000000], [0.50000000, 0.00000000, -2.00000000, 0.00000000, -2.00000000]])
B = np.array([[0.00000000, 0.00000000, 0.00000000], [0.00000000, 0.00000000, 1.00000000], [0.00000000, -1.00000000, 0.00000000], [0.50000000, 0.00000000, 0.00000000], [0.00000000, 0.00000000, 0.00000000]])
Q[0] = np.array([[3.82482782, 0.21989941, 0.51780078, 0.01058294, 0.86641730], [0.21989941, 3.86467063, 0.96407927, 0.68521105, 0.16924367], [0.51780078, 0.96407927, 7.90218063, 0.80074722, 1.13852005], [0.01058294, 0.68521105, 0.80074722, 6.67303616, -0.85125128], [0.86641730, 0.16924367, 1.13852005, -0.85125128, 4.48185586]])
R[0] = np.array([[5.59806939, 0.57986974, -4.37079616], [0.57986974, 0.73707793, 0.06357796], [-4.37079616, 0.06357796, 4.99497251]])
Q[1] = np.array([[6.69688074, -0.01475749, 1.82691568, -1.40030157, -2.07664286], [-0.01475749, 1.91407226, 0.72435122, -0.03993287, -0.58154400], [1.82691568, 0.72435122, 4.90476279, -0.48408445, -0.96169139], [-1.40030157, -0.03993287, -0.48408445, 1.99449191, 1.38555086], [-2.07664286, -0.58154400, -0.96169139, 1.38555086, 4.60097167]])
R[1] = np.array([[3.30213109, 1.97798620, -0.16275896], [1.97798620, 6.46973304, -0.77539090], [-0.16275896, -0.77539090, 5.79590229]])
Q[2] = np.array([[4.15255498, 0.14622905, 2.31273916, -0.06568069, 0.74865956], [0.14622905, 1.29299684, 0.00878413, 0.05730390, -0.04300641], [2.31273916, 0.00878413, 3.07393276, -0.13035337, -1.29572752], [-0.06568069, 0.05730390, -0.13035337, 3.68252902, -2.20549351], [0.74865956, -0.04300641, -1.29572752, -2.20549351, 4.17092230]])
R[2] = np.array([[7.80563773, -1.70732387, -0.46572462], [-1.70732387, 3.94385472, -1.79428551], [-0.46572462, -1.79428551, 7.92240110]])
Q[3] = np.array([[1.38223696, -0.12935069, -1.03335439, -0.09468545, 0.31581112], [-0.12935069, 3.76381181, 1.39388910, 0.44600446, -0.68568813], [-1.03335439, 1.39388910, 4.95448419, 0.65367844, 2.28200060], [-0.09468545, 0.44600446, 0.65367844, 4.67073571, 0.71258738], [0.31581112, -0.68568813, 2.28200060, 0.71258738, 3.35827039]])
R[3] = np.array([[2.05919512, -0.05343792, 0.41380524], [-0.05343792, 2.28822891, 0.17506334], [0.41380524, 0.17506334, 2.13660666]])

for i in range(4):
    P = np.matrix(scipy.linalg.solve_discrete_are(A, B, Q[i], R[i]))
    K = -1*np.matrix(scipy.linalg.inv((B.T)*P*B + R[i])*((B.T)*P*A))

    u = np.matmul(K, x0)

    # print(np.array2string(K, separator=","))
    J_x0 = np.matmul(x0.T, np.matmul(Q[i], x0))+np.matmul(u.T, np.matmul(R[i], u))
    J = np.matmul(x0.T, np.matmul(P, x0))

    # print(J_x0)
print(J)